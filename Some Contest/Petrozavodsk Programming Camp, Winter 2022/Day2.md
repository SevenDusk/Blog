# C. AND PLUS OR

首先需要分析一下$A_i+A_j<A_{i\and j}+A_{i\or j}$有什么性质，尝试一下减少无用的枚举量，就是去尝试证明如果存在一个二元组合法可以推出其他另外不同的二元组也是合法的

需要注意给出的$A$并没有什么特殊性质，那么我们只能在下标的范围进行有限的恒等变换

如果将i,j都看作集合的话，那么是由三部分组成$i\and j,i\backslash(i\and j),j\backslash (i\and j)$分别记作$z,x,y$

那么条件就是$A(x\or z)+A(y\or z)<A(z)+A(x\or y\or z)$

由于存在多个变量，那么首先就是考虑将一个作为变量其他都作为常量

$A(x\or z)-A(x\or y\or z)<A(z)-A(y\or z)$，那么记$f(x)=A(x\or z)-A(x\or y\or z)$，那么条件就变成$f(x)<f(\empty)$，假设固定$y,z$存在这样的$x$满足条件，假设$x=\{i_1,i_2,...,i_k\}$，集合$x_j=\{i_1,i_2,...,i_j\}$，那么一定存在某一个$j$满足$f(x_j)<f(x_{j-1})$不然的话$f(x)=f(x_{|x|})\geq f(x_{|x|-1})\geq ...f(x_1)\geq f(x_0)=f(\empty)$这样就和条件矛盾

那么令$z'=z\or x_{j-1}$，那么$A(\{i_j\}\or z')-A(\{i_j\}\or y\or z')<A(z')-A(y\or z')$

那么说明我们只需要考虑$x$为单个元素的情况即可，并且需要满足$y\and z=\empty,x\not\subset y\or z$

那么首先考虑枚举$x$，令$s=y\or z$，那么条件为$A(s)-A(x\or s)<A(z)-A(x\or z)$，由于$z\subset s $，那么可以通过高维前缀和对于所有的$s$求出其子集中$A(z)-A(x\or z)$最大值，然后枚举所有合法的$s$，判断条件是否合法即可

时间复杂度$O(2^nn^2)$

# L. Curly Racetrack

首先定义边界表示一个格子周围的四条边，那么一个网格图中$n(m-1)$个竖边界，$(n-1)m$个横边界，对于一个边界来说如果被一条路径穿过那么这个边界的状态为1，否则为0，由于块的个数总共有16种，并且四个边界的所有情况也是16种，那么说明对于任意一种四个边界被穿过的情况，都是存在一种的对应方案

那么我们就可以得到我们填完图合法的条件，就是不存在一条路径穿出网格图的边框，对于任意一个边界来说不能只有一边的格子中存在要穿过这个边界的路径

然后你考虑含curly的格子四个边界的情况，就是只有相邻的两个边界会被路径穿过，相对的边界是不会同时被路径穿过，假设一个边界被路径穿过记作1，没有被穿过记作0，那么可以在相对的两个边界并且边界上的数不同的情况下，把两个边界连接起来

那么存在curly的条件就是这个格子同时存在两个方向的线段，然后相当于两维分开了，考虑某一行的情况，就是有一些边界已经确定，那么这确定边界中间的格子有两种可能（按照长度奇偶性还有两端确定的0/1情况进行讨论），一种是全部可以划上线段，一种是只存在一个格子不能划上线段，然后你需要讨论一下ox的限制

-  如果连续段的长度%2$\neq $[左右两个确定的边界情况相同]，那么说明这个连续段中需要存在一个格子不能划线段，如果是等于的话，那么这个连续段中都是可以划上线段的

具体地就是一个连续段中间要么全部连上线段，那么只存在一个格子不能连线段，然后如果一个连续段中需要有一个格子不能连线段，存在x就肯定选在这个格子上，排除这种情况之后，如果这个连续段中都是o，那么显然不合法

考虑答案为n*m-(x的数量)-(段数)+(横段和竖段选择位置相交的数量)（这里的段指的是相邻确定边界中间格子必须要有一个不能划线段的格子段），前三项都是常数，只需要最大化最后一项，可以对横段和竖段分别建点，然后如果存在相交，那么两段之间连边，跑最大匹配就行了

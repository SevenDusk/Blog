# Crazy Painter

首先注意到当我们使用前两种操作的时候，一定会选择一段极长的连续同色段进行染色，那么也就是说选择的相同方向的染色段不会重合

也就说对于每一个格子来说在同一方向的时候只会被恰好一个连续段给覆盖到，如果两个方向的连续段都没有选择染色，那么说明需要对这个格子进行单点染色

注意到对于一个连续段来说有两种选择，染色或者不染色，并且每一个格子就是对连续段选择情况的限制，如果当前格子水平和竖直的连续段都是选择了不染色，那么就需要支付单点染色的代价

那么我们可以通过最小割建图，首先对所有连续段建立一个点

对于竖直的连续段来说，源点连向代表点的表示进行染色，容量为代价，代表点连向汇点的边表示不进行染色

对于水平的连续段来说，源点连向代表点的表示不进行染色，代表点连向汇点的边表示不进行染色，容量为代价

然后对于每一个点来说，将覆盖这个位置的竖直连续段的点连向水平连续段代表的点即可，容量为单点染色的代价

需要注意的是需要将选择的边权容量加上一个极大值D，保证只会割掉一条边

![graph (5)](D:\Blog\image\graph (5).png)

直接跑最大流即可
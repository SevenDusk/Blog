# A.Arithmetic

# B.Epidemic

首先可以考虑令$n>m$，如果一开始的输入不满足这个性质的化，那么可以直接交换左右两侧点

那么考虑整个过程，可以考虑一个$n$个点的0/1环，然后维护一个指针和一个长度为$m$的0/1序列，每一次操作就是取出维护指针之后的$m$个位置，然后依次和序列进行按位或，然后将得到的结果复制到0/1序列上以及对应的环位置上，并且将维护的指针向后移动m次

如果我们在第一次操作中无法使得所有位置都为1（也就是前m次交流中），那么我们可以将序列上的1位置对应到环上的位置

这样答案就是等于环上所有位置最晚变成1的时间，和序列上0/1情况无关

注意到一个环上的位置要变成1，一定是由之前的1位置，通过序列的复制粘贴得到的，如果位置$x$在第$i$次交流中第一次变成1，那么在第$i+m$次交流中，位置$(x+m)\bmod n$就可以变成1

那么我们可以建立一张图，使得$i$向$(i+m)\bmod n$位置连一条有向边，边权为$m$

那么对于初始的为1的位置$i$，其$d_i=i$，否则$d_i=\infin$，然后跑最短路即可

注意到这样建出来的图一定是由若干个环构成的，并且对于同一个环来说，其$\bmod \gcd(n,m)$的值相同，那么我们可以直接按照环序扫描一遍初始为1的节点即可

时间复杂度$O(A+B)$
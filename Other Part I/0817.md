需要证明的问题是

给定一个序列$x_1,x_2,...,x_{n^2+1}$，满足两两不同，那么一定存一个长度为$(n+1)$的递增子序列或者递减子序列

# 方法 1

首先如果$n=1$时，$x_1,x_2$组成的子序列要么上升要么下降，那么一定满足条件

考虑归纳证明，当$n$的情况下，满足上述条件，考虑如何推至$n+1$的情况，即对序列$x_1,x_2,...,x_{(n+1)^2+1}$​进行考虑

对于前$n^2+1$​个元素，假设所有长度为$n+1$​的递增子序列或者递减子序列的最后一项为$i_1$，如果是上升$b_{i_1}=inc$否则$b_{i_1}=dec$，然后删除这一个位置，然后将$x_{n^2+2}$补到最后，如此进行操作2n+2次

- 如果这$n+2$个位置中，有$\geq n+2$个位置是上升的，那么如果存在$a<b$满足$x_{i_a}<x_{i_b}$，那么只需将$x_{i_b}$补到$i_a$对应子序列最后，就得到了一个$n+2$长度的子序列，否则这个这些数就构成长度至少为$n+2$的子序列。对应下降的情况也是同理
- 那么相当于现在有$n+1$个位置上升记作$j_1,...,j_{n+1}$，$n+1$个位置下降，记作$k_1,...,k_{n+1}$​，根据上面的讨论情况，那么需要满足$x_{j_1}>x_{j_2}>...>x_{j_{n+1}},x_{k_1}<x_{k_2}<...<x_{k_{n+1}}$，否则就可以找到一个$n+2$的子序列
  - 考虑如果$x_{j_{n+1}}<x_{(n+1)^2+1}$，那么将$x_{(n+1)^2+1}$添到$x_{j_{n+1}}$结尾子序列的最后就行，那么考虑$x_{j_{n+1}}>x_{(n+1)^2+1}$​，就可以放到$x_{j_1},...x_{j_{n+1}}$后面，构成一个n+2的子序列，对于k也是同理
  - 那么只剩下$x_{j_{n+1}}=x_{k_{n+1}}=x_{(n+1)^2+1}$的情况，显然不存在这种情况，应为x互不相同

# 方法 2

也是归纳法，不过是从反面进行归纳，就是如果得到n+1是不合法的，那么可以推出n是不合法的，由于n=1的情况成立，那么就产生了矛盾

定义$A=\{x_i|\forall j>i,x_j<x_i\},B=\{x_i|\forall j>i,x_j >x_i\}$

有如下两个性质

- $|A|,|B|\leq n+2$​​比较显然
- $|A\cap B|=1$，就是$x_{(n+1)^2+1}$，显然一个数不能同时满足$x>x_{(n+1)^2+1}$和$x<x_{(n+1)^2+1}$这两个条件

那么可以得到$|A\cup B|\leq 2n+1$，如果将$A,B$集合中的数在序列中删去，得到的新序列至少有$n^2+1$个

假设这个新序列存在一个$n+1$长度的递增序列，那么一定存在一个$j$，使得这是一个属于A,B集合的数，然后加载最后形成n+2长度的序列

# 方法 3

假设$A_p$表示所有元素存在一个上升序列，使得这个元素是第$p$个元素的集合

首先对于$p<q$，$A_p\cap A_q=\empty$，证明也是考虑反证

假设$x_i\in A_p\cap A_q$，那么存在
$$
x_{j_1}<x_{j_2}<...<x_{j_{p-1}}<x_i<x_{j_{p+1}}<...<x_{j_{n+1}}\\
x_{j_1}<x_{j_2}<...<x_{j_{q-1}}<x_i<x_{j_{q+1}}<...<x_{j_{n+1}}\\
\rightarrow x_{j_1}<x_{j_2}<...<x_{j_{p-1}}<x_i<_{j_{q+1}}<...<x_{j_{n+1}}
$$
有$q-1+1+n-p=n+1+(q-p)\geq n+2$，与条件矛盾

那么$|A_1\cup...\cup A_{n+1}|\leq (n+1)^2+1$，，那么至少存在一个$|A_p|\leq n+1$

然后将这个移除剩下的序列有$n^2+n+1$个元素，然后同理对于下降序列进行一次移除，得到的$n^2+1$个序列

那么这个序列肯定没有长度$n+1$的递增或者递减序列，考虑反证

如果存在，那么就一定存在第$p$个元素，那么在原序列中一定需要加入一个元素，那么就得到了n+2的序列，矛盾

# 方法 4

之间考虑反证，将结束于$i$的最长上升序列记作$f(i)$，那么定义域为$[n^2+1]$，值域为$[n]$，那么一定存$i_1,...,i_{n+1}$，满足$f(i_1)=...=f(i_{n+1})=a$，显然有$1\leq j\leq n$，满足$x_{i_j}>x_{i_{j+1}}$

那么就有$x_{i_1}>x_{i_2}>...>x_{i_{n+1}}$，导出矛盾


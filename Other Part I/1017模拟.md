# 红魔乡

## 题目大意

![20211018T1](D:\Blog\image\20211018T1.PNG)

## 算法讨论

首先将所有数排序，然后如果pos上的数字不等于排序后pos上的数字那么一定不合法

暴力将应该排在这个位置的数移过来，如果跨越pos需要两次操作，首先将这个数调整到当前枚举的位置$i$关于$pos$对称的位置上$2\times pos-i$，然后再翻转$[i,2\times pos-i]$的区间，这样pos不会移动位置

如果没有跨越$pos$，那么只需要一次操作

那么相当于是说，在枚举到pos之前最大操作数为$2$，那么从pos分成两端中较小的那一段开始枚举，那么操作操作次数为$n+\min(n-pos,pos-1)\leq \frac{3n}{2}$

# 妖妖梦

## 题目大意

![20211018T2](D:\Blog\image\20211018T2.PNG)

## 算法讨论

首先由于黑色棋子可以走2距离长度，那么如果白色棋子在第一步没有吃掉黑色棋子，那么最终获胜的一定是后手，那么先手需要最大化步数，后手最小化步数

首先可以设$f(a,b,c,d,0/1)$表示白色棋子在$(a,b)$，黑色棋子在$(c,d)$，当前是先手操作还是后手操作的步数，直接进行记忆化搜索是不对的，由于转移关系上是存在环的，就会出现自己转移自己的情况

那么考虑从终止状态开始bfs转移

首先最终状态为$f(a,b,a,b,0)=0$，然后遍历可以转移到的状态，由于先手需要最大化步数，那么只有其相邻的状态答案已经确定了，才能确定这个状态，而后手需要最小化步数，那么只要有状态可以转移到它，那么就直接进行转移

时间复杂度$O(n^4)$

# 永夜抄

## 题目大意

![20211018T3](D:\Blog\image\20211018T3.PNG)

## 算法讨论

首先可以将两维状态分开考虑，可以求出走过$k$步之后，在这一维没有走出范围的答案

其中一维状态的长度为$n$，假设初始位置为$x$，设$dp(i,j)$表示走了$i$步之后，当前位置在$j$并且没有走出范围的方案数
$$
dp(i,j)=\frac{1}{4}(dp(i-1,j-1)+dp(i-1,j+1))
$$
直接递推即可，进而可以算出走过$k$步没有走出范围的概率$f(k)=\sum dp(k,i)$

那么最终答案就是
$$
\sum\limits_{k=0}^s \binom{s}{k} f(k)g(s-k)
$$
需要注意精度，需要开long double

# 花映冢

## 题目大意

![20211018T4](D:\Blog\image\20211018T4.PNG)

## 算法讨论

首先tarjan缩点，得到的图是DAG

考虑进行拓扑排序，如果过程中存在两个空余节点，那么说明从0开始走，只能走到其中一个节点，而从其中一个节点出发是无法达到另外一个节点的

那么只需要在DAG上进行拓扑排序即可，判断队列中是否始终只存在一个节点即可

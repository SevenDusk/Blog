# 匹配

## 题目大意

![20210826T1](D:\Blog\image\20210826T1.PNG)

## 算法讨论

考虑如何计算出来最小的$\sum |A_i-B_{p_i}|$，考虑两个棋子之间的空隙会被经过多少次，就是这个空隙左边A，B棋子的差，如果我们确定一个匹配是A指向B，那么同时也可以确定这个空隙被经过的方向

那么回到这问题上来，由于题目需要的是字典序最小的$p$，那么考虑从下标小的开始求出对应的最小的$B$

**根据上面的讨论可以发现一个A的棋子匹配B的方向需要跟空隙中的方向一致，并且所有空隙中的方向都要一致**

那么一开始只需要处理极长的连续同方向的空隙，并且处理这个空隙可以被经过多少次，每一次匹配时都要将区间内的空隙的次数-1

现在我们需要维护的这个空隙的序列并且支持区间减，二分出第一个次数为0 的位置，只需要一个线段树维护就可以了

然后我们还需要求出一段区间内B最小的编号是什么，还需要支持单点修改，那么也是一个线段树就可以解决的事

时间复杂度$O(n\log n)$

# 游戏

## 题目大意

![20210826T2](D:\Blog\image\20210826T2.PNG)

## 算法讨论

显然对于一个问题来说，只有三个变量会影响答案，那么就只需要将这个三个变量记录到DP状态里面，然后考虑转移即可

设$f(n,m,k)$表示这个问题的答案

转移的时候枚举当前的下注$x$​，由于我们是求最优决策在最坏情况下的答案，那么外层一定是一个max，内层就是min
$$
f(n,m,k)=\max\limits_{i=0}^k \max(\min(f(n-1,m,k+i),f(n,m-1,k-i)),\min(f(n-1,m,k-i),f(n,m-1,k+i)))
$$
直接转移的复杂度是$O(nmans^2)$​会超时

首先$f(n,m,k)=f(m,n,k)$，那么下面默认$n<m$

### 处理 1

注意到$f(n,m,k)$是关于n递减的，那么最大的答案只有5000多，那么说明我们的k一定是$\leq 5000$

由于不同的n的上限也是不同的，那么只需要打表求出这个上界就可以了

然后在记忆化搜索的过程中，判断k是否在这个上界中就行了

### 处理 2

是一个剪枝搜索，注意到如果$f(n,m-1,k-i)$​小于当前的$f(n,m,k)$​，那么就没有必要搜索$f(n-1,m,k+i)$了，另外一边也是同理

**需要注意的是必须先搜索$f(n,m-1,k-i)$​因为k会变小（比赛的时候就是搞反了）**

### 处理 3

二分最优决策，由于这个函数是递减的，那么只需要让$f(n,m-1,k-i)$和$f(n-1,m,k+i)$的差尽可能小

### 处理 4

考虑在$\frac{m-n}{n+m}k$​附件寻找最优决策点

### 处理 5

考虑将整个过程倒过来，我们可以二分枚举最终得到的答案$mid$，按照最优策略，检查进行n+m轮操作过后最多得到的钱是否$\geq k$

那么考虑递推转移记$a_{n,m}$表示状态，首先$n=0$或者$m=0$的情况很好处理，就是上次赌所有的钱，$a_{n,0}=\lceil\frac{a_{n-1,0}}{2}\rceil$

然后考虑$n,m\neq 0$的情况

由于有两种情况，$(n,m)\rightarrow (n-1,m),(n,m-1)$​​，那么根据**处理 3**可以知道，肯定是让这两种情况跟$(n,m)$的差的最大值尽可能小，那么取他们的中位数就可以了，那么有
$$
a_{n,m}=\lceil\frac{a_{n-1,m}+a_{n,m-1}}{2}\rceil
$$
时间复杂度$O(nm\log ans)$

# 矩阵

## 题目大意

![20210826T3](D:\Blog\image\20210826T3.PNG)

## 算法讨论

显然需要一行一行的进行DP，并且我们从后往前考虑

先设$dp(i,j)$表示当前走到第$i$​行第$j$个格子上的答案

然后就需要考虑在第i行这一行中反复走的过程

由于在同一行走过的格子一定是一段区间，那么设$f(l,r,0/1)$表示已经走过了$[l,r]$​区间内格子，当前在左端点还是右端点的答案

转移的时候只需要讨论下一步是向右走还是向左走就可以了

综合两个DP的答案就是可以得到最终结果

#  猫

## 题目大意 ![20210826T4](D:\Blog\image\20210826T4.PNG)

## 算法讨论

考试的时候以为是最后一题不可做，就没有多想，说明考试的时候每一道题都要分配合理的思考时间

还是比较显然可以想到二分答案，那么我们要做的就是检查$mid$是否合法

首先一开始如果前面的猫可以不搭乘运输器就可以在$mid$的时间之内走到目标节点，那么运输器就不搭载这些猫

我们需要尽可能减少停靠的次数，那么就一直走，直到运输器上搭载的最左边的猫pos恰好可以走到其位置上才停靠一次，具体的说如果当前走到$a_{pos}$的时间花费是$t$，那么最多可以走的距离是$\lfloor\frac{mid-t}{12}\rfloor$

那么同时让右边可以走到的猫也送下运输器，然后更新当前运输器 的位置

只要判断是否超时就可以了

时间复杂度$O(n\log n)$
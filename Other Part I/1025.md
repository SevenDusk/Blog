# 线性规划

首先线性规划的问题是，给定若干关于$n$个变量的等式，求一个价值函数的最大最小值

如果将等式写成矩阵形式的话，假设有$m$个限制，相当于就是将系数写成$n\times m$的矩阵$A$，将变量写成$n\times 1$的列向量$x$，等式右边写成$n\times 1$的列向量
$$
Ax=B,x\geq 0
$$
有时候可能获得的不是等式，而是不等式，可以通过增加变量变成标准形

比如$ax+by\geq c$，那么可以增加一个变量$z$使得$ax+by-z=c,z\geq 0$，那么就变成了上面的矩阵形式

## 单纯形法

这个方法的思想就是，求出这个m个等式形成的超平面的角落，然后走到周围的一个比当前更优的角落，不断重复这个过程

最坏可能要走$\binom{n+m}{n}$个角落

首先可以通过将自由变量都设为0，求出一组特殊解作为起始角落

由于我们存在$n+m$个变量（刚才转化为标准型），那么相当于其中$n$个变量都是自由变量，我们就是把这些自由变量都设为0就是得到一个角落，那么我们从一个角落走到另外一个角落的时候，就是将其中一个自由变量去除，将之前的不为自由变量的变量的其中一个加入自由变量

我们将这m个非自由变量重新标号成$x_{1...m}$，将$A$前$m$列记作$B$，后$n$列记作$N$

价值向量$c$拆成$[c_B\ c_N]$，变量向量也是同理

那么当前角落就是$x_N=0,x_B=B^{-1}b$，等式就变成了$Bx_B+Nx_N=b$，等价于$x_B+B^{-1}Nx_N=B^{-1}b$

那么价值函数就是$cx=(c_N-c_BB^{-1}N)x_N+c_BB^{-1}b$

令$r=c_N-c_BB^{-1}N$，如果$r$中每一项都是负数，那么说明代价可以更小否则如果$r>0$，那么最优解已经找到了

显然我们要加入的自由变量就是$r$中最小的那个系数的位置，在$x_N$中的第i个位置，由于我们需要维护等式成立，那么求出第一个随着$r_i$增加达到0的自由变量，这个作为去除的那个变量

如果找到的那个去除变量除以的系数都是<0，那么说明这个解是无界的

## 对偶形式

原始的形式为最小化$cx,x\geq 0,Ax\geq b$

那么其对偶形式为最大化$yb,y\geq 0,yA\leq c$

原始形式和对偶形式的最优解是相同的，当解是有界的情况下

# ABC224H Security Camera 2

## 题目大意

给定一张二分图

左边有$L$个点，右边有$R$个点，每一个点上都有一个系数，左边第i个为$A_i$，右边第i个为$B_i$

要求在每一个点上写一个数$l_i,r_i$代价为$A_il_i$，并且对于每一个二元组$(i,j)$，满足$l_i+r_j\geq C_{i,j}$

## 算法讨论

写成线性规划的形式

相当于我们现在有$L+R$个变量，之间满足$l_i+r_j\geq C_{i,j},l_i\geq 0,r_i\geq 0$

然后要求最小化$\sum A_il_i+\sum B_ir_i$

写成矩阵的形式$A$
$$
A=\begin{bmatrix}
1 & 1 & 0& ...\\ 
1 & 0 & 1& ...\\ 
1 & 0 & 0& ...\\
0 & 1 & 1& ...\\
...\\
0 & ...& 1 & 1
\end{bmatrix}
$$
其大小为$LR \times (L+R)$

考虑其对偶形式，现在有$LR$个变量$k_{i,j}$

要求对于所有的$i\in [1,L]$满足$\sum\limits_{j} k_{i,j}\leq A_i$，对于所有的$j\in [1,R]$满足$\sum\limits_{i}k_{i,j}\leq B_j$，对于所有的$k_{i,j}\geq 0$

最大化$\sum\limits_{i,j} C_{i,j}k_{i,j}$

那么就是一个类似匹配的最大费用最大流问题

建立二分图，源点向左边点连容量为$A_i$，费用为$0$的边，右边点向汇点连容量为$B_i$，费用为0的边，然后中间任意两个点之间连费用为$-C_{i,j}$，容量为$\infin$的边

然后跑最小费用流即可，其中中间的边需要加上一个大常数
# F.Mars

## 题目大意

现在有一个长度为$10^9+7$的环，每一个整点上都有一个城市

给定数组$a$，$a_i$表示第i个城市在位置$a_i$，有$q$个询问，$(L,R,D)$，表示在$a_{L...R}$中只使用长度为$D$的边，是否只将区间内的城市联通
$$
n,q\leq 2*10^5
$$

## 算法讨论

### Solution 1

如果将所有的$a_i$变成$\frac{a_i}{D}$的话，如果$a_{L...R}$可以被联通的，那么这段区间内的数应该形成了一个连续的区间（模意义下）

我们可以将$a_l$设为基准点，将$i\in [l,r],a'_i=\frac{a_i-a_l}{D}$，那么$a_i'$需要形成一个连续区间，并且这个区间应该包含0，那么说明区间左端点一定在0的负方向

不妨设左端点为$x$，那么这段区间的和为$\frac{(2x+R-L)(R-L+1)}{2}$，那么我们可以利用前缀和预处理出来$a'$在$[L,R]$的部分和，然后利用这个式子反解出$x$

如果解出的x形成的区间是不包含0的，那么说明这个区间一定不合法，但仅是这个条件不是充分的

因为可能出现-2,0,2和-1,0,1计算出来的x是一样的，但是显然前面的不合法，后面的是合法的

那么就需要将负的贡献都转为正的贡献，在计算一次看是否符合，那么只需要计算平方和即可

好像不需要计算3以及更高次方的和，2次方已经足够

### Solution 2

另外一种做法就是不除以D，然后也是通过1次方和，得到区间的左端点，然后计算二次方和和三次方和是否匹配，但是这里的公差不是1，而是D

计算的时候也需要用公差为D来进行计算

至于统计区间内1，2，3次方和，可以使用线段树或者树状数组，或者莫队实现


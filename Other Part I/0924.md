# Donkey Paradox

## 题目大意

给定$n\times m$的网格，有两个特殊点，求有多少个点出发到这两个特殊点的距离相同
$$
n,m\leq 200
$$

## 算法讨论

枚举，然后用曼哈顿距离计算

# Pokémon Evolution

## 题目大意

现在有$n$个物品，$m$个钱，用$x$个钱可以激活一个物品，也可以卖掉一个物品，获得$y$个钱，求最多可以激活多少个物品

## 算法讨论

首先判断如果$xn\leq m$，输出n

设卖掉了k个物品，那么有$k(x+y)+m\geq nx$，解得$k\geq \frac{nx-m}{x+y}$

答案就是$n-k$

# Shifted Diagonal Sum

## 题目大意

给定$n\times n$的矩阵，现在可以shift行或者列k次，求出最大对角线权值和
$$
n\leq 500
$$

## 算法讨论

枚举行和列分别shift了几次，记作$i,j$

那么答案就是$\sum\limits_{k=1}^n a_{k,(i+k-j)\bmod\  n}$

# Subarray Medians

## 题目大意

给定长度为$n$的序列，对于所有二元组$(i,j),i<j,(j-i)\%2=0$，求出$a[i...j]$组成的序列的中位数，其贡献就是$i\times j \times median$，求出贡献和
$$
n\leq 10^4
$$


## 算法讨论

考虑先从大到小枚举$i$，然后在从大到小维护$j$，在过程中用链表维护得到的有序序列，同时维护中位数的位置$pos$和数值$v$

当j减小的时候，相当于需要从链表中删去两个数，如果删除的数小于中位数的数值$v$，那么$pos$减1，如果删除的数等于中位数，那么将中位数右移一位，$pos$减1

当i减小的时候需要用set维护要插入到哪里

时间复杂度$O(n^2)$

# Xor Closure

## 题目大意

给定n个数的集合，要求求出最少需要向里面添加多少个数，使得对于任意的$A,B\in S$，使得$A$异或$B$也在集合S中

## 题目大意

相当于求出n个数集合形成的线性基，其线性空间维数就是线性基内数个数，对于异或操作，只有在整个线性空间内才是封闭的，那么要添加的数就是$2^{cnt}-n$

# Expected Tree Degrees

## 题目大意

现在要生成$n$个节点的树，依据以下的过程生成

标号从0开始，对于标号1到n-1的数$i$，随机生成$[0,i)$的数，然后连到这个节点上

求$\sum dg_i^2$的期望
$$
n\leq 10^6
$$

## 算法讨论

$$
E(\sum dg_i^2)=\sum E(dg_i^2)=2\sum E(son_i^2)
$$

考虑第i节点的儿子标号$>i$，如果对于某一个$j>i$，$j$为$i$的儿子的话，概率为$\frac{1}{j}$，不是的概率为$\frac{j-1}{j}$，可以发现跟$i$无关，那么考虑设$dp(i,0/1/2)$表示从$[i,n)$2次方的期望，1次方的期望，0次方的期望
$$
dp(i,2)=\frac{1}{i}(dp(i+1,2)+2dp(i+1,1)+dp(i+1,0)(i-1)dp(i+1,2))+\\
dp(i,1)=\frac{1}{i}(dp(i+1,1)+dp(i+1,0)+(i-1)dp(i+1,1))\\
dp(i,0)=\frac{1}{i}(dp(i+1,0)+(i-1)dp(i+1,0))
$$

# Yury's Tree

## 题目大意

给定n个节点的数，每一个节点上有权值，边上也有权值

要求支持以下两个操作

1.询问当前节点v上的权值

2.给定x,y,v，将v子树内节点u，满足u到v上的路径权值$\geq y$，将u的权值加上x
$$
n\leq 10^5
$$

## 算法讨论

首先看到$\geq y$，很容易想到克鲁斯卡尔重构树，那么不妨按照权值从大到小将重构树建出，对于第二个的操作，在v的祖先中找到深度最小的祖先$fa$使得所代表边的权值$\geq y$

可以发现，满足u到v上的路径权值$\geq y$这个条件的节点，就是$fa$子树内的节点，那么可以用dfs序来表示，就是一个区间

由于还有原树上v子树内的限制，那么还是用dfs序来表示，为一个区间

那么相当于每一个修改，给出了两个区间$[l,r],[L,R]$，每一个节点有一个二元组$(a,b)$，如果$a\in[l,r]\and b\in[L,R]$，那么将这个节点的权值+1

加上时间这一维相当于就是一个三维偏序，那么可以将其中一个区间差分成两个后缀，然后进行cdq分治即可

时间复杂度$O(n\log ^2n)$

### Solution 2

考虑有根树点分治

在分治$x$点时候，需要求出当前考虑的区域内在原树上的根，那么所有经过$x$的路径都是要从$x$到$root$路径上的点出发，到$x$子树内的点，可以处理出作为终点到x路径上的最小值，然后按照这个进行排序，然后对于x到root路径上的修改操作，考虑其对x子树内的贡献

修改的时候，对于节点$x$二分一个后缀，然后树状数组加即可

询问直接在树状数组里面查询即可
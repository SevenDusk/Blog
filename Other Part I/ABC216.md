# **G - 01Sequence**

## 题目大意

现在需要构造一个长度为$n$的01串，并且有$m$条限制$(l,r,x)$，要求$A_l,A_{l+1},...,A_r$中1的个数至少要有$x$个

并且满足1的个数最少
$$
n,m\leq 2*10^5
$$

## 算法讨论

显然可以直接差分约束，但是最坏复杂度是$O(nm)$的

考虑如何贪心的构造，问题就相当于要选出n个位置中最少的一些位置，使得所有限制的区间内选出的位置$\geq x$

如果所有区间是$x=1$，那么就是一个经典的贪心问题，稍微扩展证明过程仍然相同

那么就把所有区间按照右端点排序，然后如果区间中1的个数不满$x$个，那么就找出最靠右的位置，使得当前区间1的个数恰好为x

至于找最靠右并且没有选过的位置，可以用并查集或者链表维护，至于求一个区间内有多少个1可以用树状数组维护，当然也可以用线段树维护，然后利用线段树二分替代并查集或者链表

时间复杂度$O(n\log n)$

附上这样贪心正确的证明

证明：首先在右端点处设置一定最优，假设上一个点的位置为x

考虑$i,j$​满足$l_i,l_j>x,r_i<r_j$

那么$r_i$可以覆盖的其他区间形成的集合记作$s_i$

那么有$s_i\subset s_j$，那么说明$j$优

另解：首先可以转化为$[l,r]$内$0$的个数$\leq r-l+1-x$个，那么我们要用尽可能多的$0$扩展到尽可能近的位置

我们记$c_k$表示用k个0最近只能扩展到$c_k$这个位置

那么我们从前往后枚举，记录之前已经用过了$k$个$0$，如果$c_k\geq i$，，那么说明当前已经不能再填0了，要到$c_k+1$才能填入0，那么当前只能填1，如果$c_k<i$，就说明还可以继续扩展，就可以填$0$

至于更新$c_k$，我们记录左端点在i的所有区间，$c_{r-l+1-x+k}=\max(c_{r-l+1-x+k},r)$

时间复杂度$O(n)$


# **Strongest Takahashi**

## 题目大意

给定01矩阵，现在可以进行若干次操作，每一次选择一个$D\times D$的子矩阵，然后将子矩阵里面所有的1变成0，代价为D

求将所有位置变成0的最小代价

## 算法讨论

首先可以发现如果选择的两个子矩阵相交的话，那么如果选择能过覆盖两个子矩阵的最小D的话，那么D一定是小于两者的代价和

那么说明在最优解中所有两个矩形不相交

那么我们可以将原来的矩阵分成若干块，如果块中没有1，那么不用矩阵覆盖，否则用一个矩形进行覆盖

那么就可以DP了

设$f(a,b,c,d)$表示左上角为$(a,b)$右下角为$(c,d)$的块中将所有1变成0的最小代价

那么首先可以用一整个子矩形覆盖，那么代价为$\max(c-a+1,d-b+1)$

否则我们将这个块分裂成两个块，枚举分界点，可以竖着分也可以横着分
$$
f(a,b,c,d)=\min \limits_{i=a}^{c-1} f(a,b,i,d)+f(i+1,b,c,d)\\
f(a,b,c,d)=\min \limits_{i=b}^{d-1} f(a,b,c,i)+f(a,i+1,c,d)
$$
时间复杂度$O(n^5)$

常数很小

# **Manhattan Christmas Tree**

## 题目大意

给定平面上n个点，现在有q个询问，求出n个点到$(x,y)$曼哈顿距离的第k小值
$$
n,q\leq 10^5
$$

## 算法讨论

首先需要对于每一个询问二分答案mid，然后求出到这个点曼哈顿距离$\leq mid$的点数量

在曼哈顿距离下，圆是一个与坐标轴成45度的正方形，那么很难进行统计

那么将曼哈顿距离转化为切比雪夫距离即可，就是$(x,y)\rightarrow (x+y,x-y)$

那么在切比雪夫距离下的圆就是与坐标轴平行的正方形，相当于在$x\in[l,r],y\in [L,R]$的形式，那么如果要求在线的话，用二维线段树即可，就是每一个线段树节点中用vector存区间内y的坐标，查询的时候二分即可时间复杂度$O(n\log ^3n)$，当然也可以用可持久化线段树做到$O(n\log ^2n)$

[Submission #28149380 - AtCoder Beginner Contest 233](https://atcoder.jp/contests/abc233/submissions/28149380)

如果可以离线，那么我们将q个询问的二分一起进行处理，在处理一次的时候，将询问离线下来，然后就是一个经典的二维数点问题，用树状数组做到$O(n\log ^2 n)$

[Submission #28132198 - AtCoder Beginner Contest 233](https://atcoder.jp/contests/abc233/submissions/28132198)


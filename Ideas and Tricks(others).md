# 1.最小圆覆盖

随机增量法，随机增量法就是对于前$i$个元素，处理出来符合条件的答案，然后试图去扩展到$i+1$个位置，需要保证原来的序列是打乱过的

最小圆覆盖就是这个的应用

考虑当前扩展到第$i$个点，设当前圆为$O$，那么去判断一下$i+1$是否在$O$内，如果在那么继续下一轮判断，如果不在，那么说明$i+1$这个点一定在新的覆盖圆上，因为这个圆需要向$i+1$这个点偏移，但又同时要满足原来的点在圆内，之前已经是最小覆盖圆，有至少一个点在圆上，如果$i+1$不在圆上，那么这个圆一定可以继续缩小

那么现在可以先把圆心设为这个点，半径为$0$，然后重新枚举之前的点，看是否在圆上，如果不在把圆设为过这两个点的圆，然后继续枚举前面的点，如果还不在圆上，把圆设为经过这三个点的圆，那么不断做下去就可以找到最小覆盖圆

每一次进入下一层循环的概率都是对应下标分之$3$，那么最终期望运行复杂度为$O(n)$

# 2.判断两个集合相同

可以对全集中元素随机分配一个值域较大$unsigned$ $long$ $long$的权值，然后对于一个集合，定义其权值为所有元素的异或和，如果两个集合的权值相同，那么可以判断这两个集合相同

# 3.闵可夫斯基和

存在对于点集$A,B$定义$A+B=\{a+b|a\in A,b\in B\}$

点的加法就是向量加法

对于两个凸包内部及边界的点集做闵可夫斯基和，得到的点集依然是一个凸包，并且这个凸包可以如此构造出来

首先两个凸包的左下角的点之和一定是新凸包的左下角

然后将两个凸包的所有逆时针遍历的边看作向量，然后放到一起排序，依次按向量的方向走，得到的路径就是结果

这个就是将某一个凸包沿另一个凸包内部所有向量方向平移得到的并就是闵可夫斯基和

可以用来类似背包合并两个凸函数

# 4.曼哈顿距离转切比雪夫距离

在平面直角坐标系中，切比雪夫距离意义下的圆（一个与坐标系夹角为45度的正方形）是曼哈顿距离下的圆（边垂直与坐标轴的正方形）旋转45度，伸缩$\sqrt 2$倍

那么曼哈顿距离转切比雪夫距离$(x,y)\rightarrow (x+y,x-y)$

切比雪夫距离转曼哈顿距离$(x,y)\rightarrow(\frac{x+y}{2},\frac{x-y}{2})$

# 5.差分思想解决贪心（增量法）

给出价值函数$f$，然后求出满足$\sum p_i=n$，最大化$\sum f(p_i)$，如果$f$是一个上凸函数，就是差分后得到的序列是递减的，那么考虑将序列差分，那么每一次选出某一个位置上未选出的代价最大的那个，每一次选择都可以使当前所选的个数$+1$，那么正确性比较显然

类似于费用流分段费用拆边的做法

如果是最小化，那么如果$f$下凸同理

# 6.wqs二分

好东西

一般来说，有$n$个物品，限制只能拿$k$个物品，记选择拿$i$个物品的最优价值为$g(i)$

如果$g(i)$满足下凸或者上凸，**如果单点有限制的询问复杂度难以接受（往往是高复杂度的DP），但是若不加限制的最优解容易求出**，那么就可以考虑wqs二分

先考虑用一条直线切形成的凸包，然后求出切于哪一点，那么就可以得到当前切点和需要求出点的位置关系，那么就可以通过二分斜率得到

![20200417160123756](D:\Blog\image\20200417160123756.png)

那么现在需要求出的就是当前斜率下的切点

注意到，一条固定斜率的直线如果经过切点，其在y轴上的截距一定是在所有经过其他点的直线在y轴上的截距中最大/小的，其中上凸壳是最大的，下凸壳是最小的

![20200417162428851](D:\Blog\image\20200417162428851.png)

考虑点$(x,g(x))$，一条斜率为$k$的线经过它，在$y$轴上的截距就是$f(x)=g(x)-kx$

其中$g(x)=\sum\limits_{i=1}^x v_i$

那么$f(x)=\sum\limits_{i=1}^x(v_i-k)$

**那么就相当于每增加一个新的物品，都要减去$x$的代价**，注意不是单单将物品的代价减去$x$，有可能增加一个物品，不仅仅是对答案造成其代价的影响，还有可能跟之前已经选择的物品相互作用，对答案产生影响，而在计算代价的过程只需要将其代价$-k$，而互相影响的部分不应该进行修改

那么只要查看最优解中选取物品的个数，那么与目标点比较，更新二分边界即可

在实数二分的时候，如果凸包不是严格凸的，那么可能切不到目标点，那么就保留最接近的解

整数二分的时候，如果在斜率$k$的情况下，方案选择的个数$<aim$，斜率$k+1$的情况下，最优方案选择的个数$>aim$，那么就保留个数$\geq aim$最接近$aim$的方案，可以证明，如果保留正确，那么一定可以构造出一组合法解

其实整数二分可能无法准确的找到恰好为需要个数的方案，那么这些点肯定在同一个直线上，那么只要找出直线上最左边或者最右边的点，然后每一次更新答案

输出方案使用微扰法

> 就是一读入进来就给每一条边加个的 $10^{-7}$左右的随机权值（参数要自己调）然后跑实数域上的wqs二分，这样子可以保证刚好切到凸包上的一个点，然后直接输出选了哪些边即可。



一般来说wqs二分往往对高维DP进行优化，但是需要满足DP在某几维上满足凸性，而凸性的证明比较难

而如果DP满足凸性，那么往往可以建立出费用流模型，而费用流模型每一次增广的代价一定是凸的，那么如果可以建出费用流，那么基本上都是可以wqs二分

P.S.二分的边界尽量开满

# 7.微扰法 [Exchange argument](https://codeforces.com/blog/entry/63533)

对于某种没有确定顺序的问题，需要贪心地确定选择物品的顺序可以考虑相邻两个位置上的物品，如果交换顺序比较价值

一般会得到带有min/max的不等式，就需要讨论解出这个不等式（可以是变量分离，获得得到一个偏序关系），依次确定顺序

之后可以DP或者直接贪心求得最优解

一般经典的问题是$\frac{a_i}{b_i}<\frac{a_j}{b_j}$，还有字符串字典序比较$s+t<t+s$，对于$\max/\min  \sum\limits_{i=1}^n a_i-\sum\limits_{i=1}^{n-1}b_i$这三种类型

[Dashboard - 2016 ACM-ICPC World Finals - Codeforces](https://codeforces.com/gym/101242) Problem L Swap Space

[Dashboard - 2014-2015 ACM-ICPC, Central Europe Regional Contest (CERC 14) - Codeforces](https://codeforces.com/gym/100543) Problem K The Imp

如果在树上的问题来说，也就是对于选出的排序进行一些限制，其中一般要转化为合法排列是树上的父亲节点必须在排列中比儿子节点先出现

然后进行比较交换两个相邻的选择是否会变成更优，转化成上面三种模型

算法一是将所有树上点代表的节点顺序用一个堆进行维护，每一次选出其中最小的那个点，然后将这个点合并到父亲上，然后将两个点代表序列的信息进行合并，这样我们同时可以记录顺序，得到最终最优的序列

实现的话可以用堆加上并查集实现，时间复杂度$O(n\log n)$

算法二是考虑将所有每一个子树计算出这个子树的最佳选择序列，然后需要将当前子树根节点的所有儿子子树进行启发式合并，然后考虑加入当前的根节点

由于当前维护的序列是有序的，而需要加入的根节点一定要是第一个选择的，那么就需要将维护序列所有$\leq $的位置与当前根节点进行合并（显然当我们选择了根节点之后，一定会直接立马把比选择根节点更优的选择执行）

这样的一个好处就是可以对于任意一个子树都求出答案，至于选择序列的信息需要用数据结构进行维护

时间复杂度$O(n\log ^2n)/O(n\log n)$

[F - 01 on Tree (atcoder.jp)](https://atcoder.jp/contests/agc023/tasks/agc023_f)

[【集训队作业2018】三角形 - 题目 - Universal Online Judge (uoj.ac)](https://uoj.ac/problem/418)

[18760번: Heavy Stones (acmicpc.net)](https://www.acmicpc.net/problem/18760)

[Dashboard - 2013-2014 ACM ICPC Central European Regional Contest (CERC 13) - Codeforces](https://codeforces.com/gym/100299) Problem E Escape

# 8.射线法

判断一个顶点是否在一个多边形内部的方法，就是随意从这个点引出一条射线，这条射线要求不经过多边形上的顶点

如果这条射线与多边形的边相交奇数次，那么可以说明就在多边形内部，如果为偶数次就说明在多边形外部

注意这里的多边形可以是任意多边形

在网格图上也是可以应用的，就是判断某一个点是否被一个封闭路径包含，只要从需要判断的点引出向右上偏离微小角度的射线，这样只有行变化的时候才会影响交点数量

# 9.平面图转对偶图

首先需要建出将一条边拆成两条有向边，然后每一个点对那些起点为这个点的边进行极角排序

对于一条边$u\rightarrow v$，在$v$中找到极角序中$v\rightarrow u$的**上一条边**nxt（如果为第一个就是找最后一个，相当于形成一个环）

然后按照求出的nxt找出图中每一个环，每一个环都是代表平面图上的一个面，其中**只有一个的面积小于零**（就是外部的一个面）

然后将平面图上的一条边两端的面连接起来（这个两个面就是拆成的两个有向边所有在的环），那么就得到的对偶图

平面图上的$s-t$最小割等价于求对偶图上$s$到$t$的最短路

[2005-2006 ACM-ICPC, NEERC, Southern Subregional Contest H Great Berland Wall](https://codeforces.com/gym/100765)要求的是平面图上的一个环，使得s和t面分隔开，相当于就是对偶图上的最小割

# 10.最小表示法

# 11.随机排列相关

- 一个随机排列的LIS长度期望是$O(\sqrt n)$
- 一个随机排列的笛卡尔树最大深度期望是$O(\log n)$

# 12.模拟费用流

模拟费用流有两种不同的情况

第一种是按照原问题进行费用流建图，然后直接人工对着图进行增广维护集合

还有一种就是类似树形或者序列结构，从子树/前缀不断扩展，那么相当于费用流建图动态加点和加边，也是同样维护增广集合

而这个增广集合的维护也就是可撤销贪心的过程，一般用多个堆维护所有的可能增广路径的权值和，当加入一个新点的时候从增广路径中取出最优的进行增广即可

在增广完之后需要将新的增广路加入到堆中，也就是将撤销选项加入到堆中
